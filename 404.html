<script>
    // 修改后的startDrawing函数
    function startDrawing() {
        if (isDrawing) return;
        
        isDrawing = true;
        drawBtn.disabled = true;
        drawBtn.innerHTML = '<i class="fas fa-spinner spin"></i> 抽奖中...';
        
        // 批量生成1000条记录
        for (let i = 0; i < 1000; i++) {
            const num1 = getRandomNumber();
            const num2 = getRandomNumber();
            const num3 = getRandomNumber();
            
            currentResult = `${num1} ${num2} ${num3}`;
            
            const now = new Date();
            const dateStr = now.toLocaleDateString();
            const timeStr = now.toLocaleTimeString();
            
            // 检查是否中奖
            let isWin = false;
            myNumbers.forEach(num => {
                if (num.replace(/\s/g, '') === currentResult.replace(/\s/g, '')) {
                    isWin = true;
                }
            });
            
            history.unshift({
                date: dateStr,
                time: timeStr,
                result: currentResult,
                isWin: isWin
            });
            
            // 更新统计
            stats.drawCount++;
            if (isWin) {
                stats.winCount++;
                stats.loseStreak = 0;
            } else {
                stats.loseStreak++;
            }
        }
        
        // 显示最后一条结果
        ball1.textContent = history[0].result.split(' ')[0];
        ball2.textContent = history[0].result.split(' ')[1];
        ball3.textContent = history[0].result.split(' ')[2];
        
        // 添加弹跳动画
        if (animationCheck.checked) {
            ball1.classList.add('bounce');
            ball2.classList.add('bounce');
            ball3.classList.add('bounce');
            
            setTimeout(() => {
                ball1.classList.remove('bounce');
                ball2.classList.remove('bounce');
                ball3.classList.remove('bounce');
            }, 500);
        }
        
        // 保存数据
        localStorage.setItem('fucai3d_history', JSON.stringify(history));
        localStorage.setItem('fucai3d_stats', JSON.stringify(stats));
        
        updateStatsDisplay();
        updateHistoryDisplay();
        updateChart();
        
        isDrawing = false;
        drawBtn.disabled = false;
        drawBtn.innerHTML = '<i class="fas fa-play"></i> 开始抽奖';
    }

    // 移除原来的stopDrawing函数，因为我们现在不需要它了
</script>
