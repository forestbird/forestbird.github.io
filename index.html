<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Markdown 日志索引</title>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <h1>Markdown 日志索引</h1>
  <div id="md-list"></div>
  <hr>
  <div id="md-content"></div>
  <script>
    const repo = 'forestbird/forestbird.github.io'; // 你的仓库名
    const branch = 'main'; // 如果不是 main，请改成 master
    const dir = '_post';
    const api = `https://api.github.com/repos/${repo}/contents/${dir}?ref=${branch}`;

    // 获取 _post 下的 md 文件列表
    fetch(api)
      .then(res => res.json())
      .then(files => {
        const mdFiles = files
          .filter(f => f.name.endsWith('.md'))
          .sort((a, b) => a.name.localeCompare(b.name)); // 按文件名排序
        const list = document.getElementById('md-list');
        mdFiles.forEach(file => {
          const a = document.createElement('a');
          a.href = '#';
          a.textContent = file.name;
          a.onclick = () => loadMd(file.download_url);
          list.appendChild(a);
          list.appendChild(document.createElement('br'));
        });
        if (mdFiles.length > 0) loadMd(mdFiles[mdFiles.length - 1].download_url); // 默认显示最新
      });

    // 加载 md 文件内容
    function loadMd(url) {
      fetch(url)
        .then(res => res.text())
        .then(md => {
          document.getElementById('md-content').innerHTML = marked.parse(md);
        });
    }
  </script>
</body>
</html>
